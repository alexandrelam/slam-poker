# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

SLAM Poker is a real-time poker planning application for agile teams built with TypeScript. It consists of a Node.js backend and React frontend that communicate via WebSockets using Socket.io.

## Architecture

### Backend (`/`)

- **Entry Point**: `src/index.ts` → `src/server.ts` → `src/app.ts`
- **Socket Handling**: `src/handlers/` - Event handlers for rooms, users, and voting
- **Services**: `src/services/` - Business logic for rooms, users, permissions, and socket tracking
- **Types**: `src/types/` - TypeScript interfaces for rooms and sockets
- **Config**: Environment variables loaded via `src/config/index.ts`

### Frontend (`web/`)

- **Entry Point**: `src/main.tsx` → `src/App.tsx`
- **Routing**: React Router with conditional rendering based on app state
- **State Management**: Context API in `src/context/` (AppContext, ThemeContext)
- **Screens**: `src/screens/` - Landing, DirectJoin, and GameRoom screens
- **Components**: `src/components/` with shadcn/ui components in `ui/`
- **WebSocket**: Managed in `src/services/socketService.ts`

## Development Commands

### Backend Development

```bash
# Development with hot reload
npm run dev

# Build
npm run build

# Production start
npm start

# Linting and type checking
npm run lint
npm run typecheck
```

### Frontend Development

```bash
cd web/

# Development server
npm run dev

# Build for production
npm run build

# Lint
npm run lint
```

### Docker Development

```bash
# Start with Docker Compose
docker-compose up -d

# Rebuild and start
docker-compose up --build -d

# View logs
docker-compose logs -f slam-poker
```

## Environment Configuration

### Backend (`.env`)

- `PORT=3001` - Server port
- `NODE_ENV=production` - Environment
- `CORS_ORIGIN=*` - CORS allowed origins

### Frontend (`web/.env.development` / `web/.env.production`)

- `VITE_WS_URL=http://localhost:3001` - WebSocket URL (dev only, leave empty for production)

## Key Concepts

### Real-time Communication

- Uses Socket.io for bidirectional WebSocket communication
- Events defined in `src/types/socket.types.ts`
- Socket handlers organized by feature (room, user, voting)

### Room Management

- Rooms use 6-character codes generated by `roomCodeGenerator.ts`
- In-memory storage (no database)
- Real-time user presence tracking

### Voting System

- Fibonacci sequence cards: 0, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ?
- Hidden votes until reveal phase
- Synchronized reveal across all participants

## File Structure Notes

- Backend uses path aliases (`@/`) configured in `tsconfig.json`
- Frontend uses Vite with React, TypeScript, and Tailwind CSS
- UI components follow shadcn/ui patterns
- All state changes broadcast via WebSocket events
